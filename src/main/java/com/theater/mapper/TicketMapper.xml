<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.theater.mapper.TicketMapper">

<select id="movieList" resultType="com.theater.domain.MovieVO"> <!-- 예매화면 영화 리스트 -->
  SELECT
  DISTINCT (F.M_CD) AS M_CD ,M.TITLE,M.RATE 
  FROM MOVIES M, FILMS F
  WHERE M.M_CD = F.M_CD
  AND F.FILM_STATUS = 1
</select>


<select id="getAreaSelect" resultType="com.theater.domain.ReserveVO"> <!-- 지억 리스트 -->
      SELECT
    DISTINCT(A.AREA_NAME),F.M_CD,T_AREA 
    FROM FILMS F, SCREENS S, THEATERS T,AREAINFO A
    WHERE F.SCREEN_CD = S.SCREEN_CD 
    AND S.T_CD = T.T_CD
    AND T.T_AREA = A.AREA_CD
    AND F.M_CD = #{m_cd}
    AND F.FILM_STATUS = 1
</select>

<select id="getTheaterSelect" resultType="com.theater.domain.ReserveVO"> <!--영화관 리스트 -->     
  SELECT
        DISTINCT (T.T_AREA) AS T_AREA ,F.M_CD,T.T_NAME,T.T_CD
  FROM FILMS F, SCREENS S, THEATERS T,AREAINFO A
  WHERE F.SCREEN_CD = S.SCREEN_CD 
  AND S.T_CD = T.T_CD
  AND T.T_AREA = A.AREA_CD
  AND F.M_CD = #{m_cd}
  AND F.FILM_STATUS = 1;
</select>
<select id="getDaySelect" resultType="com.theater.domain.ReserveVO"> 
 SELECT
    (t.t_seat/t.t_screen) AS t_seat, to_char(ft.start_time,'HH24:MI') AS start_time 
    FROM FILMS F, SCREENS S, THEATERS T, FILM_TIMETABLE FT
    WHERE S.SCREEN_CD =  F.SCREEN_CD 
    AND S.T_CD = T.T_CD
    AND F.SCREEN_CD  = S.SCREEN_CD 
    AND F.FILM_CD = FT.FILM_CD 
    AND T.T_NAME = #{t_name}
    AND F.M_CD = #{m_cd}
    AND TO_CHAR(FT.start_time,'yyyy-MM-dd') = #{start_time}
    AND F.FILM_STATUS = 1
</select>


</mapper>
