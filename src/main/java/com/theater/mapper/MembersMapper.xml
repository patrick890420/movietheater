<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.theater.mapper.MembersMapper">

<!-- 회원가입 -->
<insert id="MemberInsert">
  insert all
    into members (userid,userpw,username,birth,gender,phone,email) 
        values (#{userid}, #{userpw}, #{username}, #{birth}, #{gender}, #{phone}, #{email})
    into member_auth (userid,auth) values (#{userid},'ROLE_USER')
  select*from dual
</insert>


<select id="idChk" resultType="int">
	SELECT COUNT(*) FROM MEMBERS
	WHERE userid = #{userid}
</select>

<select id="selectMember" resultType="com.theater.domain.MemberVO">
  select * from members where userid = #{userid}
  </select>
  
<update id="memberUpdate" parameterType="com.theater.domain.MemberVO">
   update members set 
   username = #{username},
   phone = #{phone},
   email = #{email}
   where userid = #{userid} 
</update>

<select id="pwChk" resultType="String">
    select count(*) from members <!--전체 비번 중복인걸 확인하는거라면 count 빼야 하는 것 아닌가...! 모르겠군 ㅋ int가 맞는지..?-->
    where userpw= #{userpw}
</select>

<select id="selectPw" resultType="com.theater.domain.MemberVO">
  select * from members where userid = #{userid}
  </select>
  
<update id="mypasspro">
update members set
userpw = #{userpw}
where userid = {#userid}
</update>

</mapper>